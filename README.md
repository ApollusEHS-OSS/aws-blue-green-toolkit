# aws-blue-green-toolkit

Utility functions to help with performing blue/green and canary deployments in AWS infrastructure

## api

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [AuroraConfig](#auroraconfig)
-   [AuroraTools](#auroratools)
    -   [getClusterState](#getclusterstate)
        -   [Parameters](#parameters)
    -   [scaleIn](#scalein)
        -   [Parameters](#parameters-1)
    -   [scaleOut](#scaleout)
        -   [Parameters](#parameters-2)
    -   [getReaderCount](#getreadercount)
        -   [Parameters](#parameters-3)
    -   [startDatabase](#startdatabase)
        -   [Parameters](#parameters-4)
    -   [stopDatabase](#stopdatabase)
        -   [Parameters](#parameters-5)
    -   [deleteDatabase](#deletedatabase)
        -   [Parameters](#parameters-6)
    -   [applyTags](#applytags)
        -   [Parameters](#parameters-7)

### AuroraConfig

[src/main/AuroraTools.ts:11-16](https://github.com/bbeesley/aws-blue-green-toolkit/blob/c27d5794307a3b815ee421844657d5916e0b740a/src/main/AuroraTools.ts#L11-L16 "Source code on GitHub")

**Extends AwsConfig**

Configuration options for the Aurora toolkit

### AuroraTools

[src/main/AuroraTools.ts:23-260](https://github.com/bbeesley/aws-blue-green-toolkit/blob/c27d5794307a3b815ee421844657d5916e0b740a/src/main/AuroraTools.ts#L23-L260 "Source code on GitHub")

Toolkit for Aurora operations

#### getClusterState

[src/main/AuroraTools.ts:61-79](https://github.com/bbeesley/aws-blue-green-toolkit/blob/c27d5794307a3b815ee421844657d5916e0b740a/src/main/AuroraTools.ts#L61-L79 "Source code on GitHub")

Gets the current state of one of the Aurora clusters

##### Parameters

-   `reference` **StackReference** Reference to a db cluster

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;ClusterState>** 

#### scaleIn

[src/main/AuroraTools.ts:120-122](https://github.com/bbeesley/aws-blue-green-toolkit/blob/c27d5794307a3b815ee421844657d5916e0b740a/src/main/AuroraTools.ts#L120-L122 "Source code on GitHub")

Reverts a cluster's minimum reader count to the configured minimum

##### Parameters

-   `reference` **StackReference** Reference to a db cluster

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;void>** 

#### scaleOut

[src/main/AuroraTools.ts:130-135](https://github.com/bbeesley/aws-blue-green-toolkit/blob/c27d5794307a3b815ee421844657d5916e0b740a/src/main/AuroraTools.ts#L130-L135 "Source code on GitHub")

Scales out a cluster to match it's partner's size

##### Parameters

-   `reference` **StackReference** Reference to a db cluster

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;void>** 

#### getReaderCount

[src/main/AuroraTools.ts:143-157](https://github.com/bbeesley/aws-blue-green-toolkit/blob/c27d5794307a3b815ee421844657d5916e0b740a/src/main/AuroraTools.ts#L143-L157 "Source code on GitHub")

Get a count of the number of active readers for a cluster

##### Parameters

-   `reference` **StackReference** Reference to a db cluster

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)>** The number of active readers

#### startDatabase

[src/main/AuroraTools.ts:165-168](https://github.com/bbeesley/aws-blue-green-toolkit/blob/c27d5794307a3b815ee421844657d5916e0b740a/src/main/AuroraTools.ts#L165-L168 "Source code on GitHub")

Starts a stopped db cluster

##### Parameters

-   `reference` **StackReference** Reference to a db cluster

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;void>** 

#### stopDatabase

[src/main/AuroraTools.ts:176-179](https://github.com/bbeesley/aws-blue-green-toolkit/blob/c27d5794307a3b815ee421844657d5916e0b740a/src/main/AuroraTools.ts#L176-L179 "Source code on GitHub")

Stops a running db cluster

##### Parameters

-   `reference` **StackReference** Reference to a db cluster

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;void>** 

#### deleteDatabase

[src/main/AuroraTools.ts:187-219](https://github.com/bbeesley/aws-blue-green-toolkit/blob/c27d5794307a3b815ee421844657d5916e0b740a/src/main/AuroraTools.ts#L187-L219 "Source code on GitHub")

Deletes a running db cluster

##### Parameters

-   `reference` **StackReference** Reference to a db cluster

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;void>** 

#### applyTags

[src/main/AuroraTools.ts:228-259](https://github.com/bbeesley/aws-blue-green-toolkit/blob/c27d5794307a3b815ee421844657d5916e0b740a/src/main/AuroraTools.ts#L228-L259 "Source code on GitHub")

Parses a message from an rds event subscription, if the event was triggered by a scale out
operation, the tags defined in config are applied to the newly created reader.

##### Parameters

-   `record` **SNSEventRecord** An SNS event record of the type published by rds event streams

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;void>** 
